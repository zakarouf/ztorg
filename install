#!/bin/bash

CCF=clang
CFLAGS='-Wall -std=c99 -O2'
HEADER='zse/ '
CFILES=''
LDFLAGS='-lncurses -lm'
ZENGINE='zse/*'

OUTEX_FILE='z'

tar -xf data.tar

#mkdir build

for d in $ZENGINE ; do
    if [[ -f $d ]]; then
        if [[ $d == *.c ]]; then
            CFILES="$CFILES $d"
        fi
    elif [[ -d $d ]]; then
            HEADER="$HEADER $d/"
        for subd in $d/* ; do
            if [[ $subd == *.c ]]; then
                CFILES="$CFILES $subd"
            fi
        done
    fi
done

$CCF $CFLAGS $LDFLAGS -I"$HEADER" -c $OUTEX_FILE $CFILES ztorg.c